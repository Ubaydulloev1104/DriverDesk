<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="DriverDesk.Pages.OrdersPage"
             Title="Активные заказы">

   <CollectionView x:Name="OrdersView"
                IsGrouped="True"
                SelectionMode="None">
    <CollectionView.GroupHeaderTemplate>
        <DataTemplate>
            <Frame BackgroundColor="#e0e0ff"
                   Padding="8"
                   CornerRadius="8"
                   HasShadow="False">
                <Label Text="{Binding Key, StringFormat='{0:dd MMMM yyyy}'}"
                       FontAttributes="Bold"
                       FontSize="18"
                       TextColor="DarkBlue"/>
            </Frame>
        </DataTemplate>
    </CollectionView.GroupHeaderTemplate>

    <CollectionView.ItemTemplate>
        <DataTemplate>
            <Frame Padding="10"
                   CornerRadius="10"
                   Margin="0,4"
                   BorderColor="LightGray"
                   HasShadow="True"
                   BackgroundColor="{Binding BackgroundColor}">
                <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto"
                      RowDefinitions="Auto,Auto,Auto"
                      ColumnSpacing="8"
                      RowSpacing="4">

                    <!-- Галочка выполнения -->
                    <Label Text="✔"
                           FontSize="24"
                           VerticalOptions="Center"
                           HorizontalOptions="Start"
                           TextColor="Green"
                           IsVisible="{Binding IsCompleted}"/>

                    <!-- Имя клиента -->
                    <Label Grid.Column="1"
                           Text="{Binding CustomerName}"
                           FontAttributes="Bold"
                           FontSize="16"/>

                    <!-- Телефон клиента -->
                    <Label Grid.Row="1"
                           Grid.Column="1"
                           Text="{Binding CustomerPhone}"
                           FontAttributes="Italic"
                           TextColor="Blue"
                           FontSize="14"/>

                    <!-- Описание заказа -->
                    <Label Grid.Row="2"
                           Grid.Column="1"
                           Text="{Binding Description}"
                           FontSize="25"/>

                    <!-- Кнопка звонка -->
                    <Button Grid.Column="2"
                            Grid.Row="2"
                            Text="📞"
                            FontSize="14"
                            WidthRequest="40"
                            Clicked="OnCallClicked"/>

                    <!-- Кнопка выполнено -->
                    <Button Grid.Column="3"
                            Grid.Row="2"
                            Text="Выполнено"
                            FontSize="14"
                            Clicked="OnCompleteClicked"
                            IsVisible="{Binding ShowCompleteButton}"/>

                    <!-- Кнопка оплачено -->
                    <Button Grid.Column="4"
                            Grid.Row="2"
                            Text="Оплачено"
                            FontSize="14"
                            Clicked="OnPaidClicked"
                            IsVisible="{Binding ShowPaidButton}"/>

                    <!-- Кнопка удалить -->
                    <Button Grid.Column="4"
                            Grid.Row="1"
                            Text="Удалить"
                            FontSize="14"
                            TextColor="Red"
                            Clicked="OnDeleteClicked"
                            IsVisible="{Binding ShowDeleteButton}"/>
                </Grid>
            </Frame>
        </DataTemplate>
    </CollectionView.ItemTemplate>
</CollectionView>

</ContentPage>
